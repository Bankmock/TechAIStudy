<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>All Video Downloader - TechAIStudy</title>
  <style>
    body { font-family: Arial, sans-serif; max-width: 600px; margin: 30px auto; text-align: center; }
    input, button { padding: 10px; margin: 10px 0; width: 90%; max-width: 500px; }
    img { max-width: 100%; border-radius: 12px; margin: 10px 0; }
    .format-box { border: 1px solid #ddd; border-radius: 6px; padding: 10px; margin: 5px 0; }
    .hidden { display: none; }
    .loading { font-style: italic; color: green; }
  </style>
</head>
<body>

  <h2>üì• All Social Media Video Downloader</h2>

  <input type="text" id="video-url" placeholder="Paste video URL here..." />
  <button onclick="fetchPreview()">üîç Preview</button>

  <div id="loading" class="loading hidden">‚è≥ Loading...</div>
  <div id="result" class="hidden">
    <h3 id="title"></h3>
    <img id="thumbnail" alt="Video thumbnail" />
    <div id="formats"></div>
  </div>

  <script>
    async function fetchPreview() {
      const url = document.getElementById('video-url').value.trim();
      if (!url) return alert("Please enter a video URL.");

      document.getElementById('loading').classList.remove('hidden');
      document.getElementById('result').classList.add('hidden');

      try {
        const response = await fetch("https://xvideoa.fun/preview", {
          method: "POST",
          headers: { "Content-Type": "application/x-www-form-urlencoded" },
          body: new URLSearchParams({ url: url })
        });

        const html = await response.text();

        // Inject response into a temp DOM to extract values
        const parser = new DOMParser();
        const doc = parser.parseFromString(html, "text/html");

        // Extract values from returned HTML
        const title = doc.querySelector("title")?.textContent || "No title";
        const thumbnail = doc.querySelector("img")?.src || "";

        const formatsEl = doc.querySelectorAll(".format-box") || [];

        document.getElementById("title").innerText = title;
        document.getElementById("thumbnail").src = thumbnail;

        const formatsDiv = document.getElementById("formats");
        formatsDiv.innerHTML = "";

        formatsEl.forEach(box => {
          formatsDiv.appendChild(box.cloneNode(true));
        });

        document.getElementById('loading').classList.add('hidden');
        document.getElementById('result').classList.remove('hidden');

      } catch (error) {
        console.error(error);
        alert("‚ùå Error fetching preview.");
        document.getElementById('loading').classList.add('hidden');
      }
    }
  </script>
</body>
</html>